<?php  
	include 'configuration-class.php';
	class Mysql extends Dbconfig_Mysql {
		public $connectionString;
		private $sqlQuery;
		public $dataSet;
		
		protected $hostDbName;
		protected $hostName;
		protected $hostUserName;
		protected $hostUserPassword;

		function Mysql() {
			$this -> connectionString = NULL;
			$this -> sqlQuery = NULL;
			$this -> dataSet = NULL;

			$dbParameter = new Dbconfig_Mysql();
			$this -> hostDbName = $dbParameter -> ServerDb;
			$this -> hostName = $dbParameter -> ServerName;
			$this -> hostUserName = $dbParameter -> ServerUserName;
			$this -> hostUserPassword = $dbParameter ->ServerUserPassword;
			$dbParameter = NULL;
		}
	  
		function dbConnect()    {
			$this -> connectionString = mysql_connect($this -> hostName,$this -> hostUserName,$this -> hostUserPassword);
			if (!$this -> connectionString) {
				die("Connection failed: " . mysql_connect_error());
			} else {
				mysql_select_db($this -> hostDbName,$this -> connectionString);
			}
			
			return $this -> connectionString;
		}

		function dbDisconnect() {
			$this -> connectionString = NULL;
			$this -> sqlQuery = NULL;
			$this -> dataSet = NULL;
			$this -> hostDbName = NULL;
			$this -> hostName = NULL;
			$this -> hostUserName = NULL;
			$this -> hostUserPassword = NULL;
		}
		function selectAll($tableName)  {
			$this -> sqlQuery = 'SELECT * FROM '.$this -> hostDbName.'.'.$tableName;
			$this -> dataSet = mysql_query($this -> sqlQuery,$this -> connectionString);
			return $this -> dataSet;
		}

		function selectWhere($tableName,$rowName,$operator,$value,$valueType)   {
			$this -> sqlQuery = 'SELECT * FROM '.$tableName.' WHERE '.$rowName.' '.$operator.' ';
			if($valueType == 'int') {
				$this -> sqlQuery .= $value;
			}
			else if($valueType == 'char')   {
				$this -> sqlQuery .= "'".$value."'";
			}
			$this -> dataSet = mysql_query($this -> sqlQuery,$this -> connectionString);
			$this -> sqlQuery = NULL;
			return $this -> dataSet;
			#return $this -> sqlQuery;
		}


		function insertInto($tableName,$values) {
			$i = NULL;

			$this -> sqlQuery = 'INSERT INTO '.$tableName.' VALUES (';
			$i = 0;
			while($values[$i]["val"] != NULL && $values[$i]["type"] != NULL) {
				if($values[$i]["type"] == "char") {
					$this -> sqlQuery .= "'";
					$this -> sqlQuery .= $values[$i]["val"];
					$this -> sqlQuery .= "'";
				}
				else if($values[$i]["type"] == 'int') {
					$this -> sqlQuery .= $values[$i]["val"];
				}
				$i++;
				if($values[$i]["val"] != NULL)  {
					$this -> sqlQuery .= ',';
				}
			}
			$this -> sqlQuery .= ')';
			#echo $this -> sqlQuery;
			mysql_query($this -> sqlQuery,$this ->connectionString);
			return $this -> sqlQuery;
			#$this -> sqlQuery = NULL;
		}

		function selectFreeRun($query) {
			$this -> dataSet = mysql_query($query,$this -> connectionString);
			return $this -> dataSet;
		}

		function freeRun($query) {
			return mysql_query($query,$this -> connectionString);
		}
	}

	class Mysqli extends Dbconfig_Mysqli {

		public $connectionString;
		private $sqlQuery;
		public $dataSet;
		
		protected $hostDbName;
		protected $hostName;
		protected $hostUserName;
		protected $hostUserPassword;

		function Mysqli() {
			$this -> connectionString = NULL;
			$this -> sqlQuery = NULL;
			$this -> dataSet = NULL;

			$dbParameter = new Dbconfig_Mysql();
			$this -> hostDbName = $dbParameter -> ServerDb;
			$this -> hostName = $dbParameter -> ServerName;
			$this -> hostUserName = $dbParameter -> ServerUserName;
			$this -> hostUserPassword = $dbParameter ->ServerUserPassword;
			$dbParameter = NULL;
		}
	  
		function dbConnect()    {
			$this -> connectionString = mysqli_connect($this -> hostName,$this -> hostUserName,$this -> hostUserPassword);
			mysqli_select_db($this -> hostDbName,$this -> connectionString);
			return $this -> connectionString;
		}

		function dbDisconnect() {
			$this -> connectionString = NULL;
			$this -> sqlQuery = NULL;
			$this -> dataSet = NULL;
			$this -> hostDbName = NULL;
			$this -> hostName = NULL;
			$this -> hostUserName = NULL;
			$this -> hostUserPassword = NULL;
		}
		function selectAll($tableName)  {
			$this -> sqlQuery = 'SELECT * FROM '.$this -> hostDbName.'.'.$tableName;
			$this -> dataSet = mysqli_query($this -> sqlQuery,$this -> connectionString);
			return $this -> dataSet;
		}

		function selectWhere($tableName,$rowName,$operator,$value,$valueType)   {
			$this -> sqlQuery = 'SELECT * FROM '.$tableName.' WHERE '.$rowName.' '.$operator.' ';
			if($valueType == 'int') {
				$this -> sqlQuery .= $value;
			}
			else if($valueType == 'char')   {
				$this -> sqlQuery .= "'".$value."'";
			}
			$this -> dataSet = mysqli_query($this -> sqlQuery,$this -> connectionString);
			$this -> sqlQuery = NULL;
			return $this -> dataSet;
			#return $this -> sqlQuery;
		}


		function insertInto($tableName,$values) {
			$i = NULL;

			$this -> sqlQuery = 'INSERT INTO '.$tableName.' VALUES (';
			$i = 0;
			while($values[$i]["val"] != NULL && $values[$i]["type"] != NULL) {
				if($values[$i]["type"] == "char") {
					$this -> sqlQuery .= "'";
					$this -> sqlQuery .= $values[$i]["val"];
					$this -> sqlQuery .= "'";
				}
				else if($values[$i]["type"] == 'int') {
					$this -> sqlQuery .= $values[$i]["val"];
				}
				$i++;
				if($values[$i]["val"] != NULL)  {
					$this -> sqlQuery .= ',';
				}
			}
			$this -> sqlQuery .= ')';
			#echo $this -> sqlQuery;
			mysqli_query($this -> sqlQuery,$this ->connectionString);
			return $this -> sqlQuery;
			#$this -> sqlQuery = NULL;
		}

		function selectFreeRun($query) {
			$this -> dataSet = mysqli_query($query,$this -> connectionString);
			return $this -> dataSet;
		}

		function freeRun($query) {
			return mysqli_query($query,$this -> connectionString);
		}
	}
?>